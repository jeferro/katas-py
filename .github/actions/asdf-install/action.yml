name: 'Install asdf'

runs:
  using: 'composite'
  steps:
    - name: Install asdf
      uses: asdf-vm/actions/setup@v4

    - name: Cache asdf
      id: asdf-cache
      uses: actions/cache@v4
      with:
        path: ~/.asdf/
        key: ${{ runner.os }}-${{ hashFiles('.tool-versions') }}

    - name: Install tools from asdf
      if: steps.asdf-cache.outputs.cache-hit != 'true'
      uses: asdf-vm/actions/install@v4

    - name: Add asdf to PATH
      shell: bash
      run: |
        echo "$HOME/.asdf/bin" >> $GITHUB_PATH
        echo "$HOME/.asdf/shims" >> $GITHUB_PATH
